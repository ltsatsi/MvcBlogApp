@using MyBlogApplication.ViewModel
@model AdminDashboardViewModel

@{
	ViewData["Title"] = "Dashboard";
}

<div class="d-flex justify-content-between align-items-center mt-4">
	<div>
		<h4>Admin @ViewData["Title"]</h4>
		<p class="small text-muted">Blog administration & moderation</p>
	</div>
	<form asp-action="DetailsForm" asp-controller="Blog" method="post">
		<div class="d-flex gap-2">
			<input type="number" id="id" name="id" required class="form-control" placeholder="Find article by id.." />
			<button type="submit" class="btn btn-primary">Find</button>
		</div>
	</form>
</div>

<div>
	<!-- Head section -->
	<div class="row mt-4">
		<!--Col 1-->
		<div class="col">
			<div class="card border-0 shadow-sm">
				<div class="card-body">
					<h6 class="card-text text-muted">
						Article Posts
					</h6>
					<h4>@Model?.Blogs.TotalCount</h4>
					<p class="text-muted small my-1 mb-2">
						Total published blog articles
					</p>
					<a asp-action="Index" asp-controller="Blog" class="btn btn-outline-primary btn-sm w-100">View All</a>
				</div>
			</div>
		</div>


		<!--Col 2-->
		<div class="col">
			<div class="card border-0 shadow-sm">
				<div class="card-body">
					<h6 class="card-text text-muted">
						Comments
					</h6>
					<h4>@Model?.Comments.TotalCount</h4>
					<p class="text-muted small my-1 mb-2">
						Total comments across whole application
					</p>
					<a asp-action="Index" asp-controller="Comment" class="btn btn-outline-primary btn-sm w-100">View All</a>
				</div>
			</div>
		</div>


		<!--Col 3-->
		<div class="col">
			<div class="card border-0 shadow-sm">
				<div class="card-body">
					<h6 class="card-text text-muted">
						Users
					</h6>
					<h4>@Model.UserCount</h4>
					<p class="text-muted small my-1 mb-2">
						Application active users
					</p>
					<a asp-action="Index" asp-controller="Account" class="btn btn-outline-primary btn-sm w-100">View All</a>
				</div>
			</div>
		</div>
	</div>

	<!-- Body section -->
	<div class="row mt-4">

		<!--Col 1-->
		<div class="col-8">
			<!-- Blog Posts Table -->
			<div class="card shadow-sm my-4">
				<div class="table-responsive">
					<table class="table table-hover align-middle mb-0">
						<thead class="small text-dark">
							<tr>
								<th>Image</th>
								<th>Title</th>
								<th>Author</th>
								<th>Date</th>
								<th class="text-end">Actions</th>
							</tr>
						</thead>
						<tbody>

							@foreach (var item in Model.Blogs)
							{
								<tr>
									<td>
										<img src="@item.ImageUrl" width="80" class="img-fluid rounded-3" />
									</td>
									<td class="text-truncate" style="max-width:150px">@item.Title</td>
									<td>@item.Author.FirstName @item.Author.LastName</td>
									<td>@item.CreatedAt.ToString("MMM dd, yyyy")</td>
									<td class="text-end">
										<a asp-action="DetailsDefault" asp-controller="Blog" asp-route-id="@item.BlogId" class="btn btn-outline-primary btn-sm">Details</a>
										<a asp-action="Delete" asp-controller="Blog" asp-route-id="@item.BlogId" class="btn btn-outline-danger btn-sm">Delete</a>
									</td>
								</tr>
							}
						</tbody>
					</table>

				</div>
			</div>

			<!-- Comment Posts Table -->
			<div class="card shadow-sm my-4">
				<div class="table-responsive">
					<table class="table table-hover align-middle mb-0">
						<thead class="small text-dark">
							<tr>
								<th>Author</th>
								<th>Content</th>
								<th>Article</th>
								<th>Date</th>
								<th class="text-end">Actions</th>
							</tr>
						</thead>
						<tbody>

							@foreach (var item in Model.Comments)
							{
								<tr>
									<td>@item.Author.FirstName @item.Author.LastName</td>
									<td class="text-truncate" style="max-width:150px">@item.Content...</td>
									<td class="text-truncate" style="max-width:150px"><a asp-action="DetailsDefault" asp-controller="Blog" asp-route-id="@item.BlogId">@item.Blog.Title</a></td>
									<td>@item.CreatedAt.ToString("MMM dd, yyyy")</td>
									<td class="text-end">
										<a asp-action="DetailsDefault" asp-controller="Blog" asp-route-id="@item.BlogId" class="btn btn-outline-primary btn-sm">Details</a>
										<a asp-action="Delete" asp-controller="Comment" asp-route-id="@item.CommentId" class="btn btn-outline-danger btn-sm">Delete</a>
									</td>
								</tr>
							}
						</tbody>
					</table>

				</div>
			</div>
		
		</div>

		<!--Col 2-->
		<div class="col-4 mt-4">
			<div class="card rounded-3 border-0 shadow-sm">
				<div class="card-footer rounded-3 bg-white">
					<h6>Quick Actions</h6>
				</div>
				<div class="card-body">
					<div class="card-body d-grid gap-2">
						<a asp-action="Profile" asp-controller="Home" class="btn btn-primary"><i class="bi bi-person me-1"></i>Admin Profile</a>
						<a asp-action="Index" asp-controller="Account" class="btn btn-outline-primary"><i class="bi bi-people me-1"></i>Manage Users</a>
						<a asp-action="Privacy" asp-controller="Home" class="btn btn-outline-primary">Moderation Rules</a>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
